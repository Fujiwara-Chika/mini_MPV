#!/bin/sh

## TYPE ## 文件类型定义
video-exts                    = avi,flv,m2ts,m4v,mkv,mov,mp4,rmvb,ts,webm     # 视频扩展名
audio-exts                    = aiff,ape,flac,m4a,mp3,ogg,opus,wav            # 音频扩展名
image-exts                    = avif,bmp,jp2,jpeg,jpg,jxl,png,tif,tiff,webp   # 图片扩展名
directory-filter-types        = video,audio,image                             # 目录过滤类型

## PLAY ## 播放通用设置
hwdec                         = auto        # 硬件解码：自动
audio-channels                = auto        # 音频通道：自动
audio-file-auto               = fuzzy       # 外挂音轨匹配：模糊
# ao                            = avfoundation # macOS 专属音频输出
vo                            = gpu-next    # 视频输出：gpu-next 渲染
volume                        = 100         # 初始音量
volume-max                    = 100         # 最大音量
image-display-duration        = 3           # 图片显示时长（秒）

pause                         = yes         # 启动时暂停
save-position-on-quit         = yes         # 退出时保存播放进度
really-quiet                  = yes         # 静默日志

target-colorspace-hint		  = no          # 色彩空间提示
loop-playlist                 = no          # 禁用循环播放
input-default-bindings        = no          # 禁用默认快捷键
icc-profile-auto              = no          # 禁用自动 ICC 色彩配置
icc-profile                   = ""          # 不指定 ICC 文件
http-proxy                    = https://127.0.0.1:7890   # HTTP 代理

cache						  = yes         # 开启缓存
demuxer-max-bytes			  = 100MiB      # 最大预读 100 MiB
# video-sync                    = display-resample
# fullscreen                    = yes

## SCREENSHOT ## 截图设置
screenshot-directory          = "~/Pictures/"            # 保存目录
screenshot-template           = "%F %wH-%wM-%wS-%wT"     # 文件名模板
screenshot-format             = jxl         # 保存格式：JPEG XL
screenshot-jxl-distance       = 0.1         # JXL 质量：视觉无损
screenshot-jxl-effort         = 1           # JXL 压缩等级
screenshot-jpeg-quality       = 100         # JPG 质量
screenshot-png-compression    = 1           # PNG 压缩级别
screenshot-webp-quality       = 100         # WebP 质量
screenshot-webp-lossless      = yes         # WebP 无损
screenshot-high-bit-depth     = yes         # 高位深截图
screenshot-tag-colorspace     = yes         # 嵌入色彩空间
# zimg-fast                     = no
# screenshot-sw                 = yes

## SUB ## 字幕设置
slang                         = chi, jpn    # 优先语言：中文、日文
sub-auto                      = exact       # 自动加载：精确匹配
sub-file-paths                = "Subs"      # 字幕搜索路径
sub-file-paths-append         = "Subs/JAP/" # 追加路径
sub-file-paths-append         = "~/Public/Subs/"
sub-file-paths-append         = "~/Downloads/Subs/"
sub-ass-use-video-data		  = none        # 不依赖视频数据渲染 ASS
sub-use-margins               = no          # 不使用边距
sub-blur                      = 0           # 字幕模糊
sub-border-size               = 1           # 边框宽度
sub-border-color              = "#1F2430"   # 边框颜色
sub-font-size                 = 48          # 字号
sub-spacing                   = 0           # 字距
sub-font                      = "HarmonyOS_Sans_SC_Medium"  # 字体
# sub-pos                       = 95
# sub-color                     = "#BED1E9"
# blend-subtitles               = video

secondary-sub-pos             = 92          # 第二字幕垂直位置
secondary-sub-ass-override    = scale       # 第二字幕 ASS 缩放

## UI ## 窗口与界面
autofit                       = 80%         # 自动缩放：80% 屏宽
autofit-larger                = 80%x80%     # 大视频自动缩放
autofit-smaller               = 40%x40%     # 小视频自动缩放
hidpi-window-scale            = yes         # HiDPI 自动缩放
macos-title-bar-appearance    = darkAqua    # macOS 标题栏外观
macos-title-bar-material      = dark        # macOS 标题栏材质
title                         = ${media-title}  # 窗口标题
# macos-geometry-calculation    = whole
# on-all-workspaces             = yes
# border                        = no 		# Windows 建议关闭边框

## OSD ## 屏幕显示信息
osd-on-seek                   = msg-bar     # 拖动时显示进度条
osd-font                      = SF Mono SC 	# 等宽字体
osd-font-size                 = 20          # OSD 字号
osd-level                     = 1           # 显示级别
osd-blur                      = 0.2         # 模糊
osd-bar-w                     = 100         # 进度条宽度
osd-bar-h                     = 1           # 进度条高度
osd-bar-align-y               = -1          # 垂直对齐
osd-border-size               = 0.5         # 边框
osd-fractions                 = yes         # 显示小数
osd-margin-x                  = 10          # 水平边距
osd-margin-y                  = 10          # 垂直边距
# osd-scale                     = 1
# osd-font-provider             = fontconfig
# osd-color                     = "#B300FFFF"
# osd-shadow-color              = "#B3008B8B"
# osd-shadow-offset             = 1
# osd-border-color              = "#B3008B8B"
# osd-bar                       = no
# osc                           = no

[HDR]  # HDR 专用配置
profile-cond                  = get("video-params/gamma") == "pq"  # 检测到 PQ 曲线启用
target-colorspace-hint        = yes
target-trc                    = pq
target-prim                   = bt.2020
target-peak                   = 1000  # 根据显示器实际亮度调整

[HQ]  # 高质量缩放配置
profile-cond                  = width < 2000 and height < 2000      # 小于 2K 时启用
glsl-shaders                  = "~~/shaders/Anime4K_Upscale_CNN_x2_S.glsl"
scale                         = bicubic_fast
cscale                        = catmull_rom
dscale                        = mitchell
tscale                        = oversample
dither-depth                  = auto
profile-restore               = copy
deband                        = yes
# interpolation                 = yes
# cscale-antiring               = 0.6
# dscale-antiring               = 0.6
# scale-antiring                = 0.6
# tscale-antiring               = 0.6
# target-prim                   = bt.709
# target-trc                    = bt.1886
# vf                            = format=gamma=gamma2.2
# tone-mapping                  = reinhard

# [image]  # 仅图片配置
# profile-cond                  = get('filename', ''):match('%.jpg$') ~= nil
# profile-cond                  = width < 2000 and height < 2000
# vo                            = libmpv
# glsl-shaders                  = "~~/shaders/Anime4K_Restore_CNN_M.glsl"
# scale                         = ewa_lanczossharp
# cscale                        = catmull_rom
# dscale                        = mitchell
# tscale                        = oversample
# dither-depth                  = auto
# deband                        = yes
# interpolation                 = yes

# [audio]  # 仅音频配置
# profile-cond                  = get('filename', ''):match('%.m4a$') ~= nil
# mute                          = no
# force-window                  = no
# no-video
# no-config